<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{fragment/main}">
<head>
    <meta charset="UTF-8">
    <title layout:fragment="title">방명록</title>

    <th:block layout:fragment="css">
        <!-- 공통 CSS 파일 로드 -->
        <link rel="stylesheet" href="/css/init.css">
        <!-- 페이지별 CSS 파일 로드 (후순위) -->
        <link rel="stylesheet" href="/css/guestbook.css">
    </th:block>
    <th:block layout:fragment="script"></th:block>
</head>
<body>
<div layout:fragment="main" id="main">
    <div id="detailWrap">
        <!-- 사용자 프로필 정보 -->
        <div id="profCard">
            <div id="profIcon">
                <!-- 프로필 이미지 표시 -->
                <img th:src="@{/guestbook/{fileName}(fileName=${member.profileImageName})}" alt="프로필 사진" id="profileImage"/>
            </div>
            <div id="profDetail">
                <!-- 사용자 닉네임, 이메일, 자기소개 -->
                <h3 th:text="${member.nickName}">닉네임</h3>
                <p th:text="${member.email}">이메일</p>
                <p th:text="${member.intro}">자기소개</p>
            </div>
        </div>

        <!-- 방명록 작성 폼 (로그인 상태에서만 보이도록 설정) -->
        <form method="post" action="/guest/writeComplete" id="inputGuestbook" sec:authorize="isAuthenticated()" th:object="${guestContent}">
            <textarea id="introInput" th:field="*{content}" placeholder="방명록을 입력하세요" required></textarea>
            <button id="introBT" type="submit">작성</button>
        </form>

        <!-- 방명록 목록 -->
        <div id="guestbookEntries">
            <div th:each="guest : ${guestbookEntries}" class="guestbook">
                <div class="guestContent">
                    <div class="guestIcon">
                        <!-- 방명록 작성자의 프로필 이미지 표시 -->
                        <img th:src="@{/images/{fileName}(fileName=${guest.profileImageName})}" alt="방명록 작성자 프로필 사진" class="guestProfileImage"/>
                    </div>
                    <div class="guestBody">
                        <!-- 방명록 본문 -->
                        <p th:text="${guest.content}">방명록 본문</p>
                    </div>
                </div>
                <!-- 방명록 신고 버튼 -->
                <a href="#" class="notify"><i class="fa-solid fa-bell"></i> 신고</a>
            </div>
        </div>

        <!-- 페이지 네비게이션 (추후 추가 필요) -->
        <div id="page">페이징을 할 경우 여기?</div>
    </div>
</div>
</body>
</html>
